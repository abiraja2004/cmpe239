Proceedings of the 49th Annual Meeting of the Association for Computational Linguistics:shortpapers, pages 524?528,
Portland, Oregon, June 19-24, 2011. c?2011 Association for Computational Linguistics
Improved Modeling of Out-Of-Vocabulary Words Using Morphological
Classes
Thomas Mu?ller and Hinrich Schu?tze
Institute for Natural Language Processing
University of Stuttgart, Germany
muellets@ims.uni-stuttgart.de
Abstract
We present a class-based language model that
clusters rare words of similar morphology
together. The model improves the predic-
tion of words after histories containing out-
of-vocabulary words. The morphological fea-
tures used are obtained without the use of la-
beled data. The perplexity improvement com-
pared to a state of the art Kneser-Ney model is
4% overall and 81% on unknown histories.
1 Introduction
One of the challenges in statistical language mod-
eling are words that appear in the recognition task
at hand, but not in the training set, so called out-
of-vocabulary (OOV) words. Especially for produc-
tive language it is often necessary to at least reduce
the number of OOVs. We present a novel approach
based on morphological classes to handling OOV
words in language modeling for English. Previous
work on morphological classes in English has not
been able to show noticeable improvements in per-
plexity. In this article class-based language mod-
els as proposed by Brown et al (1992) are used to
tackle the problem. Our model improves perplex-
ity of a Kneser-Ney (KN) model for English by 4%,
the largest improvement of a state-of-the-art model
for English due to morphological modeling that we
are aware of. A class-based language model groups
words into classes and replaces the word transition
probability by a class transition probability and a
word emission probability:
P (w3|w1w2) = P (c3|c1c2) ? P (w3|c3). (1)
Brown et al and many other authors primarily use
context information for clustering. Niesler et al
(1998) showed that context clustering works better
than clusters based on part-of-speech tags. How-
ever, since the context of an OOV word is unknown
and it therefore cannot be assigned to a cluster, OOV
words are as much a problem to a context-based
class model as to a word model. That is why we
use non-distributional features ? features like mor-
phological suffixes that only depend on the shape of
the word itself ? to design a new class-based model
that can naturally integrate unknown words.
In related work, factored language models
(Bilmes and Kirchhoff, 2003) were proposed to
make use of morphological information in highly
inflecting languages such as Finnish (Creutz et al,
2007), Turkish (Creutz et al, 2007; Yuret and Bic?ici,
2009) and Arabic (Creutz et al, 2007; Vergyri et
al., 2004) or compounding languages like German
(Berton et al, 1996). The main idea is to replace
words by sequences of factors or features and to
apply statistical language modeling to the resulting
factor sequences. If, for example, words were seg-
mented into morphemes, an unknown word would
be split into an unseen sequence, which could be rec-
ognized using discounting techniques. However, if
one morpheme, e.g. the stem, is unknown to the sys-
tem, the fundamental problem remains unsolved.
Our class-based model uses a number of features
that have not been used in factored models (e.g.,
shape and length features) and achieves ? in con-
trast to factored models ? good perplexity gains for
English.
524
is capital(w) first character of w is an uppercase letter
is all capital(w) ? c ? w : c is an uppercase letter
capital character(w) ? c ? w : c is an uppercase letter
appears in lowercase(w) ?capital character(w) ? w? ? ?T
special character(w) ? c ? w : c is not a letter or digit
digit(w) ? c ? w : c is a digit
is number(w) w ? L([+ ? ?][0 ? 9] (([., ][0 ? 9])|[0 ? 9]) ?)
not special(w) ?(special character(w) ? digit(w) ? is number(w))
Table 1: Predicates of the capitalization and special character groups. ?T is the vocabulary of the training corpus T ,
w? is obtained from w by changing all uppercase letters to lowercase and L(expr) is the language generated by the
regular expression expr.
2 Morphological Features
The feature vector of a word consists of four parts
that represent information about suffixes, capitaliza-
tion, special characters and word length. For the
suffix group, we define a binary feature for each
of the 100 most frequent suffixes learned on the
training corpus by the Reports algorithm (Keshava,
2006), a general purpose unsupervised morphology
learning algorithm. One additional binary feature is
used for all other suffixes learned by Reports, in-
cluding the empty suffix.
The feature groups capitalization and special
characters are motivated by the analysis shown in
Table 2. Our goal is to improve OOV modeling.
The table shows that most OOV words (f = 0) are
numbers (CD), names (NP), and nouns and adjec-
tives (NN, NNS, JJ). This distribution is similar to
hapax legomena (f = 1), but different from the POS
distribution of all tokens. Capitalization and special
character features are of obvious utility in identify-
ing the POS classes NP and CD since names in En-
glish are usually capitalized and numbers are writ-
ten with digits and special characters such as comma
and period. To capture these ?shape? properties of a
word, we define the features listed in Table 1.
The fourth feature group is length. Short words
often have unusual distributional properties. Exam-
ples are abbreviations and bond credit ratings like
Aaa. To represent this information in the length
part of the vector, we define four binary features for
lengths 1, 2, 3 and greater than 3. The four parts
of the vector (suffixes, capitalization, special char-
acters, length) are weighted equally by normalizing
the subvector of each subgroup to unit length.
We designed the four feature groups to group
word types to either resemble POS classes or to in-
duce an even finer sub-partitioning. Unsupervised
POS clustering is a hard task in English and it is vir-
tually impossible if a word?s context (which is not
available for OOV items) is not taken into account.
For example, there is no way we can learn that ?the?
and ?a? are similar or that ?child? has the same re-
lationship to ?children? as ?kid? does to ?kids?. But
as our analysis in Table 2 shows, part of the benefit
of morphological analysis for OOVs comes from an
appropriate treatment of names and numbers. The
suffix feature group is useful for categorizing OOV
nouns and adjectives because there are very few ir-
regular morphemes like ?ren? in children in English
and OOV words are likely to be regular words.
So even though morphological learning based on
the limited information we use is not possible in gen-
eral, it can be partially solved for the special case of
OOV words. Our experimental results in Section 5
confirm that this is the case. We also testes prefixes
and features based on word stems. However, they
produced inferior clustering solutions.
3 The Language Model
As mentioned before in the literature, e.g. by Mal-
tese and Mancini (1992), class-based models only
outperform word models in cases of insufficient
data. That is why we use a frequency-based ap-
proach and only include words below a certain to-
ken frequency threshold ? in the clustering process.
A second motivation is that the contexts of low fre-
quency words are more similar to the expected con-
texts of OOV words.
Given a training corpus, all words with a fre-
525
tag types tokens
f = 1 f = 0 (OOV)
CD 0.39 0.38 0.05
NP 0.35 0.35 0.14
NN 0.10 0.10 0.17
NNS 0.05 0.06 0.07
JJ 0.05 0.06 0.07
V* 0.04 0.05 0.15
? 0.98 0.99 0.66
Table 2: Proportion of dominant POS for types with train-
ing set frequencies f ? {0, 1} and for tokens. V* consists
of all verb POS tags.
quency below the threshold ? are partitioned into
k clusters using the bisecting k-means algorithm
(Steinbach et al, 2000). The cluster of an OOV
word w can be defined as the cluster whose centroid
is closest to the feature vector of w. The formerly
removed high-frequency words are added as single-
ton clusters to produce a complete clustering. How-
ever, OOV words can only be assigned to the orig-
inal k-means clusters. Over this clustering a class-
based trigram model can be defined, as introduced
by Brown et al (1992). The word transition proba-
bility of such a model is given by equation 1, where
ci denotes the cluster of the word wi. The class
transition probability P (c3|c1c2) is estimated using
the unsmoothed maximum likelihood estimate. The
emission probability is defined as follows:
P (w3|c3) =
?
?
?
?
?
1 if c(w3) > ?
(1 ? ?) c(w3)P
w?c3
c(w) if ??c(w3)>0
? if c(w3) = 0
where c(w) is the frequency of w in the training set.
? is estimated on held-out data. The morphologi-
cal language model is then interpolated with a modi-
fied Kneser-Ney trigram model. In this interpolation
the parameters ? depend on the cluster c2 of the his-
tory word w2, i.e.:
P (w3|w1w2) = ?(c2) ? PM (w3|w1w2)
+ (1 ? ?(c2)) ? PKN (w3|w1w2).
This setup may cause overfitting as every high fre-
quent word w2 corresponds to a singleton class. A
grouping of several words into equivalence classes
could therefore further improve the model; this,
however, is beyond the scope of this article. We es-
timate optimal parameters ?(c2) using the algorithm
described by Bahl et al (1991).
4 Experimental Setup
We compare the performance of the described model
with a Kneser-Ney model and an interpolated model
based on part-of-speech (POS) tags. The relation be-
tween words and POS tags is many-to-many, but we
transform it to a many-to-one relation by labeling
every word ? independent of its context ? with its
most frequent tag. OOV words are treated equally
even though their POS classes would not be known
in a real application. Treetagger (Schmid, 1994) was
used to tag the entire corpus.
The experiments are carried out on a Wall Street
Journal (WSJ) corpus of 50 million words that is
split into training set (80%), valdev (5%), valtst
(5%), and test set (10%). The number of distinct fea-
ture vectors in training set, valdev and validation set
(valdev+valtst) are 632, 466, and 512, respectively.
As mentioned above, the training set is used to learn
suffixes and the maximum likelihood n-gram esti-
mates. The unknown word rate of the validation set
is ? ? 0.028.
We use two setups to evaluate our methods. The
first uses valdev for parameter estimation and valtst
for testing and the second the entire validation set for
parameter estimation and the test set for testing. All
models with a threshold greater or equal to the fre-
quency of the most frequent word type are identical.
We use ? as the threshold to refer to these models.
In a similar manner, the cluster count ? denotes a
clustering where two words are in the same cluster
if and only if their features are identical. This is the
finest possible clustering of the feature vectors.
5 Results
Table 3 shows the results of our experiments. The
KN model yields a perplexity of 88.06 on valtst (top
row). For small frequency thresholds overfitting ef-
fects cause that the interpolated models are worse
than the KN model. We can see that a clustering
of the feature vectors is not necessary as the differ-
ences between all cluster models are small and c?
is the overall best model. Surprisingly, morphologi-
cal clustering and POS classes are close even though
526
? cPOS c1 c50 c100 c?
0 88.06 88.06 88.06 88.06 88.06
1 89.74 89.84 89.73 89.74 89.74
5 89.07 89.36 89.07 89.06 89.07
10 88.59 89.01 88.58 88.57 88.58
50 86.72 87.58 86.69 86.68 86.68
102 85.92 87.06 85.92 85.91 85.89
103 84.43 86.88 84.83 84.77 84.56
104 85.22 87.59 85.89 85.73 85.26
105 86.82 87.99 87.44 87.32 86.79
? 87.31 88.06 87.96 87.92 87.62
? cPOS c1 c50 c100 c?
0 813.50 813.50 813.50 813.50 813.50
1 181.25 206.17 182.78 183.62 184.43
5 152.51 185.54 154.52 152.98 153.83
10 147.48 186.12 149.34 147.98 147.48
50 146.21 203.10 142.21 140.67 140.46
102 149.06 215.54 143.95 142.48 141.67
103 173.91 279.02 164.22 159.04 150.13
104 239.72 349.54 221.42 208.85 180.57
105 317.13 373.98 318.04 297.18 236.90
? 348.76 378.38 366.92 357.80 292.34
Table 3: Perplexities for different frequency thresholds ? and cluster models. In the left table, perplexity is calculated
over all events P (w3|w1w2) of the valtst set. On the right side, the subset of events where w1 or w2 are unknown is
taken into account. The overall best results for class models and POS models are highlighted in bold.
the POS class model uses oracle information to as-
sign the right POS to an unknown word. The optimal
threshold is ? = 103 ? the bolded perplexity values
84.43 and 84.56; that means that only 1.35% of the
word types were excluded from the morphological
clustering (86% of the tokens). The improvement
over the KN model is 4%.
In a second evaluation we reduce the perplexity
calculations to predictions of the form P (w3|w1w2)
where w1 or w2 are OOV words. On such an event
the KN model has to back off to a bigram or even
unigram estimate, which results in inferior predic-
tions and higher perplexity. The perplexity for the
KN model is 813.50 (top row). A first observation
is that the perplexity of model c1 starts at a good
value, but worsens with rising values for ? ? 10.
The reason is the dominance of proper nouns and
cardinal numbers at a frequency threshold of one and
in the distribution of OOV words (cf. Table 2). The
c1 model with ? = 1 is specialized for predicting
words after unknown nouns and cardinal numbers
and two thirds of the unknown words are of exactly
that type. However, with rising ?, other word classes
get a higher influence and different probability dis-
tributions are superimposed. The best morphologi-
cal model c? reduces the KN perplexity of 813.50
to 140.46 (bolded), an improvement of 83%.
As a final experiment, we evaluated our method
on the test set. In this case, we used the entire
validation set for parameter tuning (i.e., valdev and
valtst). The overall perplexity of the KN model is
88.28, the perplexities for the best POS and c? clus-
ter model for ? = 1000 are 84.59 and 84.71 respec-
tively, which corresponds again to an improvement
of 4%. For unknown histories the KN model per-
plexity is 767.25 and the POS and c? cluster model
perplexities at ? = 50 are 150.90 and 144.77. Thus,
the morphological model reduces perplexity by 81%
compared to the KN model.
6 Conclusion
We have presented a new class-based morphological
language model. In an experiment the model outper-
formed a modified Kneser-Ney model, especially in
the prediction of the continuations of histories con-
taining OOV words. The model is entirely unsuper-
vised, but works as well as a model using part-of-
speech information.
Future Work. We plan to use our model for do-
main adaptation in applications like machine trans-
lation. We then want to extend our model to other
languages, which could be more challenging, as cer-
tain languages have a more complex morphology
than English, but also worthwhile, if the unknown
word rate is higher. Preliminary experiments on
German and Finnish show promising results. The
model could be further improved by using contex-
tual information for the word clustering and training
a classifier based on morphological features to as-
sign OOV words to these clusters.
Acknowledgments. This research was funded by
DFG (grant SFB 732). We would like to thank Hel-
mut Schmid and the anonymous reviewers for their
valuable comments.
527
References
Lalit R. Bahl, Peter F. Brown, Peter V. de Souza,
Robert L. Mercer, and David Nahamoo. 1991. A fast
algorithm for deleted interpolation. In Speech Com-
munication and Technology, pages 1209?1212.
Andre Berton, Pablo Fetter, and Peter Regel-Brietzmann.
1996. Compound words in large-vocabulary German
speech recognition systems. In Spoken Language, vol-
ume 2, pages 1165 ?1168 vol.2, October.
Jeff A. Bilmes and Katrin Kirchhoff. 2003. Factored
language models and generalized parallel backoff. In
Human Language Technology, NAACL ?03, pages 4?
6. Association for Computational Linguistics.
Peter F. Brown, Peter V. de Souza, Robert L. Mercer, Vin-
cent J. Della Pietra, and Jenifer C. Lai. 1992. Class-
based n-gram models of natural language. Computa-
tional Linguistics, 18:467?479, December.
Mathias Creutz, Teemu Hirsima?ki, Mikko Kurimo, Antti
Puurula, Janne Pylkko?nen, Vesa Siivola, Matti Var-
jokallio, Ebru Arisoy, Murat Sarac?lar, and Andreas
Stolcke. 2007. Morph-based speech recognition
and modeling of out-of-vocabulary words across lan-
guages. ACM Transactions on Speech and Language
Processing, 5:3:1?3:29, December.
Samarth Keshava. 2006. A simpler, intuitive approach
to morpheme induction. In PASCAL Challenge Work-
shop on Unsupervised Segmentation of Words into
Morphemes, pages 31?35.
Giulio Maltese and Federico Mancini. 1992. An auto-
matic technique to include grammatical and morpho-
logical information in a trigram-based statistical lan-
guage model. In Acoustics, Speech, and Signal Pro-
cessing, volume 1, pages 157 ?160 vol.1, March.
Thomas R. Niesler, Edward W.D. Whittaker, and
Philip C. Woodland. 1998. Comparison of part-of-
speech and automatically derived category-based lan-
guage models for speech recognition. In Acoustics,
Speech and Signal Processing, volume 1, pages 177
?180 vol.1, May.
Helmut Schmid. 1994. Probabilistic part-of-speech tag-
ging using decision trees. In New Methods in Lan-
guage Processing, pages 44?49.
Michael Steinbach, George Karypis, and Vipin Kumar.
2000. A comparison of document clustering tech-
niques. In KDD Workshop on Text Mining.
Dimitra Vergyri, Katrin Kirchhoff, Kevin Duh, and An-
dreas Stolcke. 2004. Morphology-based language
modeling for Arabic speech recognition. In Spoken
Language Processing, pages 2245?2248.
Deniz Yuret and Ergun Bic?ici. 2009. Modeling morpho-
logically rich languages using split words and unstruc-
tured dependencies. In International Joint Conference
on Natural Language Processing, pages 345?348. As-
sociation for Computational Linguistics.
528
